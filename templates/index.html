{% if qr_generated %}
    <h3>Your QR Code:</h3>
    <img id="qrImage" src="{{ url_for('static', filename='vcard_qr.png') }}" alt="vCard QR Code" width="200"><br><br>

    <!-- Download Button -->
    <a href="{{ url_for('static', filename='vcard_qr.png') }}" download="vcard_qr.png">
        <button>Download QR Code</button>
    </a>

    <!-- Share Button -->
    <button onclick="shareQR()">Share QR Code</button>

    <script>
        async function shareQR() {
            if (navigator.canShare && navigator.canShare({ files: [] })) {
                const response = await fetch("{{ url_for('static', filename='vcard_qr.png') }}");
                const blob = await response.blob();
                const file = new File([blob], "vcard_qr.png", { type: "image/png" });

                try {
                    await navigator.share({
                        title: "vCard QR Code",
                        text: "Here's my contact QR",
                        files: [file]
                    });
                } catch (err) {
                    alert("Share failed: " + err);
                }
            } else {
                alert("Sharing not supported on this device/browser.");
            }
        }
    </script>
{% endif %}
